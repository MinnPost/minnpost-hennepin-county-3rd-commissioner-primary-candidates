/*! minnpost-hennepin-county-3rd-commissioner-primary-candidates - v0.0.0 - 2014-04-24
* https://github.com/minnpost/minnpost-hennepin-county-3rd-commissioner-primary-candidates
* Copyright (c) 2014 MinnPost; Licensed MIT */

define("helpers",["jquery","underscore","backbone"],function(a,b,c){var d={};return c.ajax=function(){var a=arguments;return a[0].dataTypeForce!==!0&&(a[0].dataType="jsonp",a[0].jsonpCallback="mpServerSideCachingHelper"+b.hash(a[0].url)),c.$.ajax.apply(c.$,a)},d.isMSIE=function(){var a=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return a?parseInt(a[2],10):!1},d.jsonpRequest=function(c,d){return options.dataType="jsonp",options.jsonpCallback="mpServerSideCachingHelper"+b.hash(options.url),d.remoteProxy&&(options.url=options.url+"&callback=mpServerSideCachingHelper",options.url=d.remoteProxy+encodeURIComponent(options.url),options.cache=!0),a.ajax.apply(a,[options])},d.getLocalData=function(c,e){var f=!1,g=[];return c=b.isArray(c)?c:[c],e&&e.paths&&0===e.paths.data.indexOf("http")&&(f=!0),b.each(c,function(b){var c;c=f?d.jsonpRequest({url:proxyPrefix+encodeURI(e.paths.data+b)},e):a.getJSON(e.paths.data+b),g.push(c)}),a.when.apply(a,g)},d.parseQueryString=function(){var a={},c=function(a){return decodeURIComponent(a.replace(/\+/g," "))},d=location.search.substring(1),e=d.split("&");return b.each(e,function(b){var d=b.split("=");d.length>1&&(a[c(d[0])]=c(d[1]))}),a},d}),define("models",["underscore","backbone"],function(a,b){var c={};return c.Base=b.Model.extend({initialize:function(a,b){this.options=b||{},this.app=b.app}}),c.Question=c.Base.extend({idAttribute:"questionid"}),c.Candidate=c.Base.extend({idAttribute:"candidateid"}),c.Category=c.Base.extend({idAttribute:"categoryid"}),c}),define("collections",["underscore","backbone","models"],function(a,b,c){var d={};return d.Base=b.Collection.extend({initialize:function(a,b){this.options=b||{},this.app=b.app}}),d.Questions=d.Base.extend({model:c.Question}),d.Candidates=d.Base.extend({model:c.Candidate}),d.Categories=d.Base.extend({model:c.Category}),d}),define("text!templates/application.mustache",[],function(){return'<div class="application-container">\n  <div class="message-container"></div>\n\n  <div class="content-container">\n\n    <div class="candidate-list">\n      <div class="row">\n        {{#candidates}}\n          <div class="candidate column-medium-15 {{#eliminated}}eliminated{{/eliminated}}">\n            {{ name }}\n          </div>\n        {{/candidates}}\n      </div>\n\n      <div class="options">\n        <button on-tap="clearQuestions" class="button xsmall danger">Clear all</button>\n      </div>\n    </div>\n\n\n    <div class="category-list">\n      {{#categories}}\n        <button class="button xsmall category">\n          {{ category }}\n        </button>\n      {{/categories}}\n    </div>\n\n\n    <div class="question-list">\n      {{#questions}}\n        <div class="question {{ state }}">\n          <div class="question-text">{{ question }}</div>\n          <div class="question-options">\n            <button on-tap="answer:[\'Y\', {{ questionid }}]" class="button small primary {{#(answer === \'Y\')}}active{{/()}}">Yes</button>\n            <button on-tap="answer:[\'N\', {{ questionid }}]" class="button small primary {{#(answer === \'N\')}}active{{/()}}">No</button>\n            <button on-tap="answer:[\'C\', {{ questionid }}]" class="button small info">Clear</button>\n          </div>\n        </div>\n      {{/questions}}\n    </div>\n\n\n\n  </div>\n\n  <div class="footnote-container">\n    <div class="footnote">\n      <p>Some code, techniques, and data on <a href="https://github.com/minnpost/minnpost-hennepin-county-3rd-commissioner-primary-candidates" target="_blank">Github</a>.</p>\n\n        <p>Some map data © OpenStreetMap contributors; licensed under the <a href="http://www.openstreetmap.org/copyright" target="_blank">Open Data Commons Open Database License</a>.  Some map design © MapBox; licensed according to the <a href="http://mapbox.com/tos/" target="_blank">MapBox Terms of Service</a>.  Location geocoding provided by <a href="http://www.mapquest.com/" target="_blank">Mapquest</a> and is not guaranteed to be accurate.</p>\n\n    </div>\n  </div>\n</div>\n'}),define("text!templates/loading.mustache",[],function(){return'<div class="loading-container">\n  <div class="loading"><span>Loading...</span></div>\n</div>'}),define("views",["jquery","underscore","ractive","ractive-backbone","ractive-events-tap","text!templates/application.mustache","text!templates/loading.mustache"],function(a,b,c,d,e,f,g){var h={};return h.Base=c.extend({baseInit:function(a){this.app=a.app},adapt:["Backbone"]}),h.Application=h.Base.extend({template:f,partials:{loading:g},init:function(){this.baseInit.apply(this,arguments)}}),h}),define("text!../data/preferences.json",[],function(){return'{"Candidate guide to Hennepin County 3rd Commissioner Primary":{"Questions":[{"category":"Partisanship","question":"Do you want a candidate who sought DFL endorsement?","eliminatesony":"carney, reuer","eliminatesonn":"greene, mavity, kelash, schweigert","unknownstance":"","na":"","rowNumber":1},{"category":"Union support","question":"Do you want a candidate with union support?","eliminatesony":"greene, carney, reuer","eliminatesonn":"mavity, kelash, schweigert","unknownstance":"","na":"","rowNumber":2},{"category":"Union support","question":"Do you want a candidate supported by AFSCME, Teamsters, and Hennepin County Sheriff’s Deputies?","eliminatesony":"mavity, greene, carney, reuer, kelash","eliminatesonn":"schweigert","unknownstance":"","na":"","rowNumber":3},{"category":"Union support","question":"Do you want a candidate supported by the Carpenters, Building Trades, Laborerers, Locomotive workers?","eliminatesony":"mavity, greene, carney, reuer, schweigert","eliminatesonn":"kelash","unknownstance":"","na":"","rowNumber":4},{"category":"Residence","question":"Do you want a candidate who lives in Minneapolis?","eliminatesony":"mavity","eliminatesonn":"greene, carney, reuer, kelash, schweigert","unknownstance":"","na":"","rowNumber":5},{"category":"Residence","question":"Do you want a candidate who lives in St. Louis Park?","eliminatesony":"greene, carney, reuer, kelash, schweigert","eliminatesonn":"mavity","unknownstance":"","na":"","rowNumber":6},{"category":"Elected experience","question":"Do you want a candidate with previous elected experience?","eliminatesony":"carney, reuer, schweigert","eliminatesonn":"greene, kelash, mavity","unknownstance":"","na":"","rowNumber":7},{"category":"Minneapolis mayoral election","question":"Do you want a candidate who endorsed Mark Andrew for 2013 Minneapolis mayor?","eliminatesony":"carney, reuer, schweigert, mavity","eliminatesonn":"greene, kelash","unknownstance":"","na":"","rowNumber":8},{"category":"Southwest LRT","question":"Do you want a candidate who would replace Southwest LRT with busways?","eliminatesony":"greene, mavity, kelash, schweigert, reuer","eliminatesonn":"carney","unknownstance":"","na":"","rowNumber":9},{"category":"Endorsements","question":"Do you want a candidate endorsed by Progressive Majority and the St. Louis Park City Council?","eliminatesony":"greene, carney, reuer, kelash, schweigert","eliminatesonn":"mavity","unknownstance":"","na":"","rowNumber":10},{"category":"Endorsements","question":"Do you want a candidate endorsed by Stonewall DFL, Dee Long, Margaret Kelliher and Hennepin Commissioner Linda Higgins?","eliminatesony":"mavity, carney, reuer, kelash, schweigert","eliminatesonn":"greene","unknownstance":"","na":"","rowNumber":11},{"category":"Endorsements","question":"Do you want a candidate endorsed by Rep. Joe Mullery and former NRP director Bob Miller? ","eliminatesony":"mavity, carney, reuer, schweigert, greene","eliminatesonn":"kelash","unknownstance":"","na":"","rowNumber":12},{"category":"Endorsements","question":"Do you want a candidate endorsed by Minneapolis School Board members Mammen, Monserrate and Gagnon?","eliminatesony":"mavity, carney, reuer, kelash, schweigert","eliminatesonn":"greene","unknownstance":"","na":"","rowNumber":13},{"category":"Endorsements","question":"Do you want a candidate endorsed by County Attoney Mike Freeman and Reps. Karen Clark & Susan Allen?","eliminatesony":"mavity, greene, carney, reuer, kelash","eliminatesonn":"schweigert","unknownstance":"","na":"","rowNumber":14},{"category":"Endorsements","question":"Do you want a candidate endorsed by the GOP?","eliminatesony":"greene, mavity, kelash, schweigert, reuer","eliminatesonn":"carney","unknownstance":"","na":"","rowNumber":15}],"Candidates":[{"candidateid":"carney","name":"Bob “Again” Carney Jr.","profileurl":"http://www.minnpost.com/community-voices/2014/04/hennepin-commissioner-candidate-demand-southwest-lrt-alternatives","rowNumber":1},{"candidateid":"reuer","name":"Bob Reuer","profileurl":"","rowNumber":2},{"candidateid":"greene","name":"Marion Greene","profileurl":"http://www.minnpost.com/politics-policy/2014/04/hennepin-county-commissioner-election-interview-marion-greene","rowNumber":3},{"candidateid":"mavity","name":"Anne Mavity","profileurl":"http://www.minnpost.com/politics-policy/2014/04/hennepin-county-commissioner-election-interview-anne-mavity","rowNumber":4},{"candidateid":"kelash","name":"Ken Kelash","profileurl":"http://www.minnpost.com/politics-policy/2014/04/hennepin-county-commissioner-election-interview-ken-kelash","rowNumber":5},{"candidateid":"schweigert","name":"Ben Schweigert","profileurl":"http://www.minnpost.com/politics-policy/2014/04/hennepin-county-commissioner-election-interview-ben-schweigert","rowNumber":6}]}}'}),define("minnpost-hennepin-county-3rd-commissioner-primary-candidates",["jquery","underscore","leaflet","mpConfig","mpFormatters","mpMaps","helpers","models","collections","views","text!../data/preferences.json"],function(a,b,c,d,e,f,g,h,i,j,k){var l=function(c){this.options=b.extend(this.defaultOptions,c),this.el=this.options.el,this.$el=a(this.el),this.$=function(a){return this.$el.find(a)},this.$content=this.$el.find(".content-container"),this.loadApp()};return b.extend(l.prototype,{start:function(){this.loadData(),this.applicationView=new j.Application({el:this.$el,data:{candidates:this.candidates,questions:this.questions,categories:this.categories},app:this}),this.handleEvents()},handleEvents:function(){var a=this;this.applicationView.on("answer",function(b,c){var d=c[0],e=c[1];a.questions.get(e).set("answer","C"===d?null:d)}),this.applicationView.on("clearQuestions",function(){a.questions.each(function(a){a.set("answer",null)})}),this.questions.on("change:answer",function(b){b.set("state",b.get("answer")?"answered":"unanswered"),a.eliminateCandidates()})},eliminateCandidates:function(){var a=this;this.candidates.each(function(a){a.set("eliminated",!1)}),this.questions.each(function(c){"Y"===c.get("answer")&&b.each(c.get("eliminatesony"),function(b){a.candidates.get(b).set("eliminated",!0)}),"N"===c.get("answer")&&b.each(c.get("eliminatesonn"),function(b){a.candidates.get(b).set("eliminated",!0)})})},loadData:function(){var c="Questions",d="Candidates";this.rawData=JSON.parse(k),this.rawData=this.rawData[b.keys(this.rawData)[0]],this.candidates=new i.Candidates(b.map(this.rawData[d],function(a){return a.eliminated=!1,a}),{app:this}),this.questions=new i.Questions(b.map(this.rawData[c],function(c){return c.eliminatesonn=b.filter(b.map(c.eliminatesonn.split(","),a.trim),function(a){return!!a}),c.eliminatesony=b.filter(b.map(c.eliminatesony.split(","),a.trim),function(a){return!!a}),c.unknownstance=b.filter(b.map(c.unknownstance.split(","),a.trim),function(a){return!!a}),c.categoryid=e.identifier(c.category),c.questionid=b.uniqueId("question-"),c.state="unanswered",c.answer=null,c}),{app:this}),this.categories=new i.Categories(this.questions.map(function(a){return a.pick("category","categoryid")}),{app:this})},defaultOptions:{projectName:"minnpost-hennepin-county-3rd-commissioner-primary-candidates",remoteProxy:null,el:".minnpost-hennepin-county-3rd-commissioner-primary-candidates-container",availablePaths:{local:{css:[".tmp/css/main.css"],images:"images/",data:"data/"},build:{css:["//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css","dist/minnpost-hennepin-county-3rd-commissioner-primary-candidates.libs.min.css","dist/minnpost-hennepin-county-3rd-commissioner-primary-candidates.latest.min.css"],ie:["dist/minnpost-hennepin-county-3rd-commissioner-primary-candidates.libs.min.ie.css","dist/minnpost-hennepin-county-3rd-commissioner-primary-candidates.latest.min.ie.css"],images:"dist/images/",data:"dist/data/"},deploy:{css:["//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css","https://s3.amazonaws.com/data.minnpost/projects/minnpost-hennepin-county-3rd-commissioner-primary-candidates/minnpost-hennepin-county-3rd-commissioner-primary-candidates.libs.min.css","https://s3.amazonaws.com/data.minnpost/projects/minnpost-hennepin-county-3rd-commissioner-primary-candidates/minnpost-hennepin-county-3rd-commissioner-primary-candidates.latest.min.css"],ie:["https://s3.amazonaws.com/data.minnpost/projects/minnpost-hennepin-county-3rd-commissioner-primary-candidates/minnpost-hennepin-county-3rd-commissioner-primary-candidates.libs.min.ie.css","https://s3.amazonaws.com/data.minnpost/projects/minnpost-hennepin-county-3rd-commissioner-primary-candidates/minnpost-hennepin-county-3rd-commissioner-primary-candidates.latest.min.ie.css"],images:"https://s3.amazonaws.com/data.minnpost/projects/minnpost-hennepin-county-3rd-commissioner-primary-candidates/minnpost-hennepin-county-3rd-commissioner-primary-candidates/images/",data:"https://s3.amazonaws.com/data.minnpost/projects/minnpost-hennepin-county-3rd-commissioner-primary-candidates/minnpost-hennepin-county-3rd-commissioner-primary-candidates/data/"}}},loadApp:function(){this.determinePaths(),this.getLocalAssests(function(a){this.renderAssests(a),this.start()})},determinePaths:function(){var a;this.options.deployment="deploy",-1!==window.location.host.indexOf("localhost")&&(this.options.deployment="local",a=g.parseQueryString(),b.isObject(a)&&b.isString(a.mpDeployment)&&(this.options.deployment=a.mpDeployment)),this.options.paths=this.options.availablePaths[this.options.deployment]},getLocalAssests:function(b){var c=this;"local"===this.options.deployment?a.getJSON("bower.json",function(a){b.apply(c,[a.dependencyMap])}):b.apply(this,[])},renderAssests:function(c){var d=g.isMSIE()&&g.isMSIE()<=8;b.isObject(c)&&b.each(c,function(c){c.css&&b.each(c.css,function(b){b=b.match(/^(http|\/\/)/)?b:"bower_components/"+b+".css",a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')}),c.ie&&d&&b.each(c.ie,function(b){b=b.match(/^(http|\/\/)/)?b:"bower_components/"+b+".css",a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')})}),b.each(this.options.paths.css,function(b){a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')}),d&&b.each(this.options.paths.ie,function(b){a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')}),this.$el.addClass("inline-processed")}}),l}),require(["jquery","minnpost-hennepin-county-3rd-commissioner-primary-candidates"],function(a,b){a(document).ready(function(){new b})});